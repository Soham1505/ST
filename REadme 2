package practical5;
import jxl.write.Label;
import jxl.write.WritableSheet;
import jxl.write.WritableWorkbook;
import java.io.*;
import jxl.*;
import org.testng.annotations.*;
import org.testng.annotations.BeforeClass;
public class Student_Record {
@BeforeClass //@BeforeClass runs once before the entire test.
public void setUp() throws Exception{}
@Test
public void testImportexport1() throws Exception {
FileInputStream fi = new FileInputStream("C:\\Users\\Student\\Desktop\\student1X.xls");
Workbook w = Workbook.getWorkbook (fi);
Sheet s=w.getSheet(0);
String a[][] = new String[s.getRows()][s.getColumns()];
FileOutputStream fo = new FileOutputStream("C:\\Users\\Student\\Desktop\\Result1.xls");
WritableWorkbook wwb = Workbook.createWorkbook (fo);
WritableSheet ws = wwb.createSheet ("result1", 0);
for (int i = 0; i < s.getRows(); i++)
for (int j = 0; j <s.getColumns(); j++){
a[i][j] = s.getCell(j, i).getContents();
Label l2 = new Label (j, i, a[i][j]);
ws.addCell (l2);
Label l1 = new Label (6, 0, "Result");
ws.addCell(l1);}
for (int i = 1; i < s.getRows(); i++){
for (int j = 2; j <s.getColumns(); j++){
a[i][j] = s.getCell(j, i).getContents();
int x=Integer.parseInt(a[i][j]);
if(x > 35){
Label l1 = new Label(6, i, "pass");
ws.addCell(l1);}
else{
Label l1 = new Label(6, i, "fail");
ws.addCell(l1);
break;}}
System.out.println("Records sucessfully updated ");}
wwb.write();
wwb.close();}







  package practical6;
import jxl.write.Label;
import jxl.write.WritableSheet;
import jxl.write.WritableWorkbook;
import java.io.*;
import jxl.*;
import org.testng.annotations.*;
import org.testng.annotations.BeforeClass;
public class testing {
@Test
public void testImportexport1() throws Exception {
FileInputStream fi = new FileInputStream("C:\\Users\\Student\\Desktop\\student.xls");
Workbook w = Workbook.getWorkbook (fi);
Sheet s=w.getSheet(0);
String a[][] = new String[s.getRows()][s.getColumns()];
FileOutputStream fo = new FileOutputStream("C:\\Users\\Student\\Desktop\\result.xls");
WritableWorkbook wwb = Workbook.createWorkbook (fo);
WritableSheet ws = wwb.createSheet ("result1", 0);
int newRow = 0; // target row index
for (int i = 1; i < s.getRows(); i++) // start from 1 (skip header)
{
int cMarks = Integer.parseInt(s.getCell(2, i).getContents()); // Column C
int dMarks = Integer.parseInt(s.getCell(3, i).getContents()); // Column D
int eMarks = Integer.parseInt(s.getCell(4, i).getContents()); // Column E
// If ANY subject has marks >= 60
if (cMarks >= 60 || dMarks >= 60 || eMarks >= 60)
{
for (int j = 0; j < s.getColumns(); j++)
{
String value = s.getCell(j, i).getContents();
Label l2 = new Label(j, newRow, value);
ws.addCell(l2);
}

newRow++; // move to next output row
}
}
wwb.write();
wwb.close();
}
}
